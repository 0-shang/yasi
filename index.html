<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æ™ºèƒ½èƒŒè¯</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        :root {
            --primary: #5856D6; /* iOS Indigo */
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --text: #1C1C1E;
            --sub: #8E8E93;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }
        body { margin: 0; font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            padding: 15px 20px; background: rgba(242,242,247,0.9); backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center; z-index: 10;
            border-bottom: 0.5px solid rgba(0,0,0,0.1);
        }
        .header h1 { margin: 0; font-size: 20px; font-weight: 700; }
        .header i { font-size: 22px; color: var(--primary); cursor: pointer; }

        /* ä¸»è§†å›¾ */
        .viewport { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 100px; }
        
        /* å¡ç‰‡é€šç”¨ */
        .card { background: var(--card); border-radius: 16px; padding: 20px; margin-bottom: 15px; box-shadow: var(--shadow); position: relative; }
        
        /* 1. ä¹¦æ¶ç•Œé¢ */
        .stat-banner {
            background: linear-gradient(135deg, #5856D6, #AC8EFA); color: white; padding: 25px; border-radius: 20px; margin-bottom: 25px;
            display: flex; justify-content: space-around; text-align: center;
        }
        .stat-item .num { font-size: 24px; font-weight: 800; display: block; }
        .stat-item .label { font-size: 12px; opacity: 0.9; }

        .book-item { display: flex; align-items: center; transition: 0.2s; border: 2px solid transparent; }
        .book-item.active { border-color: var(--primary); background: #eef2ff; }
        .book-info { flex: 1; margin-left: 15px; }
        .book-info h3 { margin: 0 0 5px; font-size: 17px; }
        .book-badges span { font-size: 10px; padding: 3px 8px; border-radius: 4px; background: #f2f2f7; color: var(--sub); margin-right: 5px; }
        .book-badges .badge-due { background: #fee2e2; color: #ef4444; } /* å¾…å¤ä¹  */
        
        /* 2. å­¦ä¹ ç•Œé¢ */
        .study-container { height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .flashcard {
            width: 100%; height: 60vh; position: relative; perspective: 1000px; cursor: pointer;
        }
        .flashcard-inner {
            width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d;
            border-radius: 24px; box-shadow: var(--shadow); background: var(--card);
        }
        .flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
        
        .face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden; -webkit-backface-visibility: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; box-sizing: border-box;
        }
        .front { z-index: 2; }
        .back { transform: rotateY(180deg); align-items: flex-start; justify-content: flex-start; overflow-y: auto; text-align: left; }
        
        .word-lg { font-size: 48px; font-weight: 800; margin-bottom: 20px; text-align: center; }
        .meaning-box { font-size: 18px; line-height: 1.6; color: #333; width: 100%; }
        
        /* åº•éƒ¨æ“ä½œæ  */
        .action-bar {
            position: fixed; bottom: 85px; width: 90%; max-width: 500px;
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;
        }
        .btn {
            border: none; padding: 15px 0; border-radius: 12px; font-weight: bold; color: white; font-size: 16px;
            display: flex; flex-direction: column; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        .btn span { font-size: 10px; font-weight: normal; margin-top: 2px; opacity: 0.9; }
        .btn-again { background: #FF3B30; }
        .btn-hard { background: #FF9500; }
        .btn-easy { background: #34C759; }

        /* è®¾ç½®å¼¹çª— */
        .modal-mask {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100;
            display: flex; align-items: center; justify-content: center;
        }
        .modal { background: white; width: 80%; padding: 25px; border-radius: 20px; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-size: 14px; color: var(--sub); }
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }

        /* åº•éƒ¨ Tab */
        .tab-bar {
            position: fixed; bottom: 0; width: 100%; background: rgba(255,255,255,0.95); backdrop-filter: blur(20px);
            border-top: 0.5px solid rgba(0,0,0,0.1); padding-bottom: var(--safe-bottom);
            display: flex; justify-content: space-around; height: 60px; z-index: 50;
        }
        .tab-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #999; font-size: 10px; }
        .tab-item.active { color: var(--primary); }
        .tab-item i { font-size: 24px; margin-bottom: 2px; }
    </style>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨ -->
        <div class="header">
            <h1>{{ pageTitle }}</h1>
            <i v-if="currentTab === 'library'" class="ri-settings-3-line" @click="showSettings=true"></i>
        </div>

        <!-- ä¸»å†…å®¹ -->
        <div class="viewport">
            
            <!-- 1. ä¹¦æ¶ (Library) -->
            <div v-if="currentTab === 'library'">
                <div class="stat-banner">
                    <div class="stat-item">
                        <span class="num">{{ globalStats.todayLearned }}</span>
                        <span class="label">ä»Šæ—¥å·²å­¦</span>
                    </div>
                    <div class="stat-item">
                        <span class="num">{{ globalStats.due }}</span>
                        <span class="label">å¾…å¤ä¹ </span>
                    </div>
                    <div class="stat-item">
                        <span class="num">{{ settings.dailyLimit }}</span>
                        <span class="label">æ¯æ—¥æ–°è¯</span>
                    </div>
                </div>

                <div style="font-size:14px; color:var(--sub); margin-bottom:10px; font-weight:600">æˆ‘çš„è¯ä¹¦</div>
                
                <div v-if="books.length === 0" class="card" style="text-align:center; padding:40px 20px" @click="$refs.fileInput.click()">
                    <i class="ri-add-circle-fill" style="font-size:40px; color:var(--primary)"></i>
                    <p style="margin:10px 0 5px">å¯¼å…¥ CSV å•è¯ä¹¦</p>
                    <p style="font-size:12px; color:#999">æ ¼å¼ï¼šå•è¯, æ„æ€ (æ— è¡¨å¤´)</p>
                </div>

                <div v-for="book in books" :key="book.id" class="card book-item" :class="{active: currentBookId === book.id}" @click="selectBook(book.id)">
                    <div style="width:40px; height:40px; background:#F2F2F7; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px;">ğŸ“˜</div>
                    <div class="book-info">
                        <h3>{{ book.name }}</h3>
                        <div class="book-badges">
                            <span class="badge-due" v-if="getBookStats(book.id).due > 0">{{ getBookStats(book.id).due }} å¾…å¤ä¹ </span>
                            <span>æ€»è¯æ•° {{ book.total }}</span>
                            <span>è¿›åº¦ {{ getBookStats(book.id).progress }}%</span>
                        </div>
                    </div>
                    <i class="ri-delete-bin-line" style="color:#FF3B30; padding:10px" @click.stop="deleteBook(book.id)"></i>
                </div>
            </div>

            <!-- 2. å­¦ä¹  (Study) -->
            <div v-if="currentTab === 'study'" class="study-container">
                <div v-if="!currentBookId" style="text-align:center; color:#999">
                    <i class="ri-book-open-line" style="font-size:60px"></i>
                    <p>è¯·å…ˆåœ¨ä¹¦æ¶é€‰æ‹©ä¸€æœ¬ä¹¦</p>
                    <button @click="currentTab='library'" style="padding:10px 30px; background:var(--primary); color:white; border:none; border-radius:20px; font-size:16px; margin-top:10px">å»é€‰ä¹¦</button>
                </div>

                <div v-else-if="sessionOver" style="text-align:center; color:#34C759">
                    <i class="ri-checkbox-circle-fill" style="font-size:80px"></i>
                    <h2>ä»Šæ—¥æ‰“å¡æˆåŠŸ!</h2>
                    <p>æœ¬æ—¥æ–°è¯é…é¢ä¸å¤ä¹ ä»»åŠ¡å·²å®Œæˆ</p>
                    <button @click="currentTab='library'" style="margin-top:20px; padding:10px 30px; background:#F2F2F7; color:#333; border:none; border-radius:20px">è¿”å›</button>
                </div>

                <template v-else-if="currentWord">
                    <div class="flashcard" :class="{flipped: isFlipped}" @click="flipCard">
                        <div class="flashcard-inner">
                            <div class="face front">
                                <div style="position:absolute; top:20px; right:20px; font-size:12px; color:#999">
                                    {{ queueType === 'review' ? 'ğŸ”´ å¤ä¹ ' : 'ğŸ”µ æ–°è¯' }}
                                </div>
                                <div class="word-lg">{{ currentWord.word }}</div>
                                <div style="font-size:13px; color:#999; margin-top:20px">ç‚¹å‡»æŸ¥çœ‹é‡Šä¹‰</div>
                            </div>
                            <div class="face back">
                                <div style="width:100%; border-bottom:1px solid #eee; padding-bottom:10px; margin-bottom:15px; color:var(--primary); font-weight:bold; font-size:24px;">{{ currentWord.word }}</div>
                                <div class="meaning-box">{{ currentWord.meaning }}</div>
                            </div>
                        </div>
                    </div>

                    <div class="action-bar" v-if="isFlipped">
                        <button class="btn btn-again" @click.stop="rate(1)">å¿˜è®°<span>1åˆ†é’Ÿ</span></button>
                        <button class="btn btn-hard" @click.stop="rate(2)">æ¨¡ç³Š<span>10åˆ†é’Ÿ</span></button>
                        <button class="btn btn-easy" @click.stop="rate(3)">è®¤è¯†<span>{{ nextIntervalStr }}</span></button>
                    </div>
                </template>
            </div>
        </div>

        <!-- åº•éƒ¨ Tab -->
        <div class="tab-bar">
            <div class="tab-item" :class="{active: currentTab==='study'}" @click="currentTab='study'">
                <i class="ri-macbook-line"></i><span>å­¦ä¹ </span>
            </div>
            <div class="tab-item" :class="{active: currentTab==='library'}" @click="currentTab='library'">
                <i class="ri-book-2-line"></i><span>ä¹¦æ¶</span>
            </div>
        </div>

        <!-- éšè—æ–‡ä»¶è¾“å…¥ -->
        <input type="file" ref="fileInput" accept=".csv" style="display:none" @change="importCSV">

        <!-- è®¾ç½®å¼¹çª— -->
        <div class="modal-mask" v-if="showSettings" @click.self="showSettings=false">
            <div class="modal">
                <h3 style="margin-top:0">å­¦ä¹ è®¾ç½®</h3>
                <div class="input-group">
                    <label>æ¯æ—¥æ–°è¯ä¸Šé™ (ä¸ª)</label>
                    <input type="number" v-model.number="settings.dailyLimit">
                </div>
                <button @click="saveSettings" style="width:100%; padding:12px; background:var(--primary); color:white; border:none; border-radius:10px; font-size:16px;">ä¿å­˜</button>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, computed, onMounted, watch } = Vue;
        const DB_NAME = 'SmartVocab_V4'; // å‡çº§ç‰ˆæœ¬å·

        // IndexedDB å°è£…
        const openDB = () => new Promise((resolve) => {
            const req = indexedDB.open(DB_NAME, 1);
            req.onupgradeneeded = e => {
                const db = e.target.result;
                if (!db.objectStoreNames.contains('books')) db.createObjectStore('books', { keyPath: 'id' });
                if (!db.objectStoreNames.contains('progress')) db.createObjectStore('progress', { keyPath: 'key' });
                if (!db.objectStoreNames.contains('logs')) db.createObjectStore('logs', { keyPath: 'date' }); // æ¯æ—¥å­¦ä¹ è®°å½•
            };
            req.onsuccess = e => resolve(e.target.result);
        });

        createApp({
            setup() {
                const currentTab = ref('library');
                const showSettings = ref(false);
                const db = ref(null);
                
                // æ•°æ®çŠ¶æ€
                const books = ref([]);
                const currentBookId = ref(localStorage.getItem('currBookId'));
                const settings = ref(JSON.parse(localStorage.getItem('settings')) || { dailyLimit: 20 });
                
                // å­¦ä¹ ä¼šè¯çŠ¶æ€
                const sessionQueue = ref([]);
                const currentWord = ref(null);
                const isFlipped = ref(false);
                const progressCache = ref({}); // { wordId: { level, nextReview... } }
                const todayLearnedCount = ref(0);
                
                const pageTitle = computed(() => currentTab.value === 'library' ? 'æˆ‘çš„ä¹¦æ¶' : 'å¼€å§‹å­¦ä¹ ');
                const queueType = computed(() => {
                    if(!currentWord.value) return '';
                    const p = progressCache.value[currentWord.value.id];
                    return (p && p.level > 0) ? 'review' : 'new';
                });
                
                const nextIntervalStr = computed(() => {
                    // ç®€å•é¢„æµ‹ï¼šå¦‚æœæ˜¯æ–°è¯ -> 1å¤©ï¼Œå¦‚æœæ˜¯å¤ä¹  -> å½“å‰é—´éš” * 2
                    if(!currentWord.value) return '';
                    const p = progressCache.value[currentWord.value.id];
                    if(!p || p.level === 0) return '1å¤©';
                    return Math.round(p.interval * 2) + 'å¤©';
                });

                // åˆå§‹åŒ–
                onMounted(async () => {
                    db.value = await openDB();
                    refreshLibrary();
                    loadDailyLog();
                });

                // --- ä¸šåŠ¡é€»è¾‘ ---

                // 1. å¯¼å…¥ CSV
                const importCSV = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        const text = ev.target.result;
                        const lines = text.replace(/\r\n/g, '\n').split('\n');
                        const words = [];
                        lines.forEach(line => {
                            const idx = line.indexOf(','); // ç®€å•åˆ†å‰²
                            if(idx > 0) {
                                const w = line.slice(0, idx).trim();
                                const m = line.slice(idx+1).trim().replace(/^"|"$/g, ''); // å»å¼•å·
                                if(w && m) words.push({ id: w.toLowerCase(), word: w, meaning: m });
                            }
                        });
                        
                        if(words.length === 0) return alert('æ ¼å¼é”™è¯¯ï¼šç¬¬ä¸€åˆ—å•è¯ï¼Œç¬¬äºŒåˆ—æ„æ€');
                        
                        const book = { id: Date.now().toString(), name: file.name.replace('.csv',''), total: words.length, words };
                        const tx = db.value.transaction('books', 'readwrite');
                        tx.objectStore('books').put(book);
                        tx.oncomplete = () => { refreshLibrary(); alert('å¯¼å…¥æˆåŠŸ'); };
                    };
                    reader.readAsText(file, 'UTF-8');
                };

                // 2. åˆ·æ–°ä¹¦æ¶æ•°æ®
                const refreshLibrary = async () => {
                    const tx = db.value.transaction(['books', 'progress'], 'readonly');
                    // è·å–æ‰€æœ‰ä¹¦
                    tx.objectStore('books').getAll().onsuccess = e => { books.value = e.target.result; };
                    // è·å–æ‰€æœ‰è¿›åº¦
                    tx.objectStore('progress').getAll().onsuccess = e => {
                        const all = e.target.result;
                        // æŒ‰ä¹¦IDå½’ç±»ç¼“å­˜
                        const map = {};
                        all.forEach(p => map[p.key] = p);
                        progressCache.value = map; // è¿™é‡Œ key = bookId_wordId
                    };
                };

                // 3. è®¡ç®—å•æœ¬ä¹¦ç»Ÿè®¡ (è¿›åº¦ã€å¾…å¤ä¹ )
                const getBookStats = (bookId) => {
                    const prefix = bookId + '_';
                    let learned = 0;
                    let due = 0;
                    const now = Date.now();
                    
                    // éå†ç¼“å­˜ (ç®€å•å®ç°ï¼Œæ•°æ®é‡ç‰¹åˆ«å¤§æ—¶éœ€ä¼˜åŒ–)
                    for (let key in progressCache.value) {
                        if (key.startsWith(prefix)) {
                            const p = progressCache.value[key];
                            if (p.level > 0) learned++;
                            if (p.nextReview <= now) due++;
                        }
                    }
                    
                    const book = books.value.find(b => b.id === bookId);
                    const total = book ? book.total : 1;
                    return { progress: Math.round(learned/total*100), due };
                };
                
                // å…¨å±€ç»Ÿè®¡
                const globalStats = computed(() => {
                    let dueTotal = 0;
                    const now = Date.now();
                    for(let key in progressCache.value) {
                        if(progressCache.value[key].nextReview <= now) dueTotal++;
                    }
                    return { todayLearned: todayLearnedCount.value, due: dueTotal };
                });

                // 4. é€‰æ‹©ä¹¦å¹¶ç”Ÿæˆå­¦ä¹ é˜Ÿåˆ— (æ ¸å¿ƒç®—æ³•)
                const selectBook = async (id) => {
                    currentBookId.value = id;
                    localStorage.setItem('currBookId', id);
                    
                    const tx = db.value.transaction('books', 'readonly');
                    tx.objectStore('books').get(id).onsuccess = e => {
                        const book = e.target.result;
                        if(book) {
                            generateSession(book.words);
                            currentTab.value = 'study';
                        }
                    };
                };

                const generateSession = (allWords) => {
                    const now = Date.now();
                    const bookId = currentBookId.value;
                    const reviews = [];
                    const news = [];
                    
                    // æ£€æŸ¥å½“æ—¥æ–°è¯é™é¢
                    const newWordsLeft = Math.max(0, settings.value.dailyLimit - todayLearnedCount.value);

                    allWords.forEach(w => {
                        const key = `${bookId}_${w.id}`;
                        const p = progressCache.value[key];
                        
                        if (p) {
                            // å¤ä¹ ï¼šæ—¶é—´åˆ°äº†æˆ–è€…æ˜¯"å­¦ä¹ ä¸­"çŠ¶æ€
                            if (p.nextReview <= now) reviews.push(w);
                        } else {
                            // æ–°è¯
                            if (news.length < newWordsLeft) news.push(w);
                        }
                    });

                    // ä¼˜å…ˆå¤ä¹ ï¼Œå†å­¦æ–°è¯
                    sessionQueue.value = [...reviews, ...news];
                    loadNext();
                };

                const loadNext = () => {
                    if(sessionQueue.value.length > 0) {
                        currentWord.value = sessionQueue.value[0];
                        isFlipped.value = false;
                    } else {
                        currentWord.value = null;
                    }
                };
                
                const sessionOver = computed(() => currentBookId.value && sessionQueue.value.length === 0 && !currentWord.value);

                // 5. è¯„åˆ†ä¸ç®—æ³• (Simplified SM-2)
                const rate = (quality) => {
                    const w = currentWord.value;
                    const key = `${currentBookId.value}_${w.id}`;
                    let p = progressCache.value[key] || { level: 0, interval: 0, ef: 2.5 };
                    
                    const now = Date.now();
                    let nextReview = now;

                    // é€»è¾‘ï¼š
                    // quality 1 (å¿˜): levelå½’0, 1åˆ†é’Ÿåé‡æ¥
                    // quality 2 (æ¨¡ç³Š): levelä¸å˜, 10åˆ†é’Ÿåé‡æ¥
                    // quality 3 (è®¤è¯†): level+1, é—´éš”å¢åŠ 
                    
                    if (quality === 1) {
                        p.level = 0;
                        p.interval = 0;
                        nextReview = now + 60 * 1000; // 1 min
                    } else if (quality === 2) {
                        p.level = 0; // æ¨¡ç³Šç®—ä½œé‡æ–°å­¦ä¹ 
                        p.interval = 0;
                        nextReview = now + 10 * 60 * 1000; // 10 min
                    } else {
                        // è®¤è¯†
                        if (p.level === 0) p.interval = 1; // 1å¤©
                        else if (p.level === 1) p.interval = 3; // 3å¤©
                        else p.interval = Math.round(p.interval * p.ef);
                        
                        p.level++;
                        nextReview = now + p.interval * 24 * 60 * 60 * 1000;
                        
                        // åªæœ‰ç¬¬ä¸€æ¬¡å˜æˆâ€œè®¤è¯†â€æ‰ç®—ä»Šæ—¥æ–°å­¦
                        if (!progressCache.value[key]) {
                            todayLearnedCount.value++;
                            updateDailyLog();
                        }
                    }

                    // ä¿å­˜è¿›åº¦
                    const record = { key, wordId: w.id, ...p, nextReview };
                    progressCache.value[key] = record; // æ›´æ–°å†…å­˜
                    const tx = db.value.transaction('progress', 'readwrite');
                    tx.objectStore('progress').put(record); // æ›´æ–°æ•°æ®åº“

                    // UI è°ƒåº¦
                    sessionQueue.value.shift(); // ç§»é™¤å½“å‰
                    if (quality < 3) {
                        // å¦‚æœä¸ç†Ÿï¼Œæ’å…¥é˜Ÿå°¾ç»§ç»­èƒŒ
                        sessionQueue.value.push(w);
                    }
                    
                    loadNext();
                    isFlipped.value = false;
                };

                // è¾…åŠ©ï¼šæ¯æ—¥è®°å½•
                const loadDailyLog = () => {
                    const date = new Date().toLocaleDateString();
                    const tx = db.value.transaction('logs', 'readonly');
                    tx.objectStore('logs').get(date).onsuccess = e => {
                        if(e.target.result) todayLearnedCount.value = e.target.result.count;
                    };
                };
                const updateDailyLog = () => {
                    const date = new Date().toLocaleDateString();
                    const tx = db.value.transaction('logs', 'readwrite');
                    tx.objectStore('logs').put({ date, count: todayLearnedCount.value });
                };

                const flipCard = () => {
                    isFlipped.value = !isFlipped.value;
                    if(isFlipped.value) {
                        const u = new SpeechSynthesisUtterance(currentWord.value.word);
                        u.lang = 'en-US';
                        window.speechSynthesis.speak(u);
                    }
                };

                const saveSettings = () => {
                    localStorage.setItem('settings', JSON.stringify(settings.value));
                    showSettings.value = false;
                    // å¦‚æœæ”¹äº†é™é¢ï¼Œé‡æ–°ç”Ÿæˆé˜Ÿåˆ—
                    if(currentBookId.value) selectBook(currentBookId.value);
                };

                const deleteBook = (id) => {
                    if(!confirm('åˆ é™¤ä¹¦å’Œè®°å½•ï¼Ÿ')) return;
                    const tx = db.value.transaction('books', 'readwrite');
                    tx.objectStore('books').delete(id);
                    tx.oncomplete = () => {
                        refreshLibrary();
                        if(currentBookId.value === id) {
                            currentBookId.value = null;
                            currentWord.value = null;
                        }
                    };
                };

                return {
                    currentTab, showSettings, books, currentBookId, currentWord, isFlipped, 
                    sessionQueue, settings, globalStats, sessionOver, queueType, nextIntervalStr,
                    pageTitle, importCSV, selectBook, deleteBook, saveSettings, getBookStats,
                    flipCard, rate
                };
            }
        }).mount('#app');

        if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
    </script>
</body>
</html>